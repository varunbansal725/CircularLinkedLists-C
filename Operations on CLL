#include <stdio.h>
#include <stdlib.h>

struct Node {
    int data;
    struct Node *next;
}*head=NULL, *first=NULL;

void create(int arr[], int size) {
    struct Node *t, *tail;
    head=(struct Node *)malloc(sizeof(struct Node));
    head->data=arr[0];
    head->next=NULL;
    tail=head;
    for(int i=1; i < size; i++) {
        t=(struct Node *)malloc(sizeof(struct Node));
        t->data=arr[i];
        t->next=NULL;
        tail->next=t;
        tail=t;
    }
    tail->next=head;
}

void display(struct Node *p) {
    while(p->next!=head) {
        printf("%d ", p->data);
        p=p->next;
    }
    printf("%d\n", p->data);
}


void display1(struct Node *p) {
    while(p->next!=first) {
        printf("%d ", p->data);
        p=p->next;
    }
    printf("%d\n", p->data);
}

void display1(struct Node *p) {
    while(p->next!=third) {
        printf("%d ", p->data);
        p=p->next;
    }
    printf("%d\n", p->data);
}


int count(struct Node *p) {
    int k;
    while(p->next!=head) {
        k++;
        p=p->next;
    }
    k++;
        return k;
    }

void verify_circular_list(struct Node *p) {
    struct Node *tail=head;
    while(tail->next!=head)
        tail=tail->next;

    if(tail->next==head)
        printf("The list is a circular linked list\n");
    else
        printf("The list is not a circular linked list\n");
}

void insert(struct Node *p, int position, int element) {
    struct Node *t, *tail=head;
    if(position > 0 && position <= 10) {
    t=(struct Node *)malloc(sizeof(struct Node));
    t->data=element;
    t->next=NULL;
    while(tail->next!=head)
        tail=tail->next;
    if(position==0) {
        t->next=head;
        head=t;
        tail->next=head;
    }
    else {
        for(int i=0; i < position-1; i++)
            p=p->next;
            t->next=p->next;
            p->next=t;
    }
    }
    else
        printf("Position not defined\n");
}

void delete(struct Node *p, int position) {
    struct Node *temp, *tail=head;
    int k=0;
    while(tail->next!=head)
        tail=tail->next;

    if(position==0) {
        temp=head;
        head=head->next;
        tail->next=head;
        free(temp);
    }
    else {

    while(p->next!=head && k < position-1) {
        k++;
        temp=p;
        p=p->next;
    }
    temp->next=p->next;
    free(p);
    p=temp->next;
}
}

int search(struct Node *p, int element) {
    int i=0;
    while(p->next!=head) {
    if(p->data==element)
        return i;
    else
        i++;
        p=p->next;
    }
}

void reverse() {
    struct Node *p, *q, *tail;
    q=head;
    p=head->next;
    head=head->next;
    q->next=NULL;
    tail=q;
    while(p->next!=tail) {
        head=head->next;
        p->next=q;
        q=p;
        p=head;
        }
        p->next=q;
        tail->next=head;
}

void copy() {
    struct Node *t, *last, *temp, *tail;
    temp=head;
    tail=head;
    while(tail->next!=head)
        tail=tail->next;
    first=(struct Node *)malloc(sizeof(struct Node));
    first->data=head->data;
    first->next=NULL;
    last=first;
    temp=temp->next;
    while(temp!=head) {
        t=(struct Node *)malloc(sizeof(struct Node));
        t->data=temp->data;
        t->next=NULL;
        last->next=t;
        last=t;
        temp=temp->next;
    }
     last->next=first;
}

void delete_list(struct Node *p) {
    struct Node *temp, *tail=head;
    while(tail->next!=head)
        tail=tail->next;

    while(p!=tail) {
        temp=p;
        p=p->next;
        free(temp);
        head=p;
    tail->next=head;
    }
    free(p);
}

void concatenate(struct Node *p, struct Node *q) {
    third=p;
    if(p==first && q==head) {
    while(p->next!=first)
        p=p->next;
    p->next=q;
    while(q->next!=head)
        q=q->next;
    q->next=third;
}
    else if(q==first && p==head) {
    while(p->next!=head)
        p=p->next;
    p->next=q;
    while(q->next!=first)
        q=q->next;
    q->next=third;
    }
}


void main() {
    int size;
    int A[10]={1,2,3,4,5,6,7,8,9,10};
    size = sizeof(A) / sizeof(A[0]);
    create(A, size);
    display(head);
    printf("List is of length: %d\n", count(head));
    verify_circular_list(head);
    printf("After element insertion: ");
    insert(head, 10, 5);
    display(head);
    printf("List is of length: %d \n", count(head));
    delete(head, 11);
    printf("After deletion of element: ");
    display(head);
    printf("Element found at: %d\n", search(head, 8));
    printf("List after reversing: ");
    reverse();
    display(head);
    copy();
    display1(first);
    /* delete_list(head);
    display(head); */
    concatenate(head, first);
    display2(third);
}
